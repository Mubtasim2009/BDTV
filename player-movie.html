<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BDTV VOD – Movie Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" type="image/webp" href="https://raw.githubusercontent.com/Mubtasim2009/Aboutme/c74e8b467a2abce57120a9b1d39eb0edb8e1c038/assets/brand/ICON.webp" />

  <style>
    :root {
      color-scheme: dark;
      --bg-main: #020916;
      --accent: #e50914;
      --text-main: #f5f5f5;
      --text-muted: #a7b0c5;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #101933 0, #020916 55%);
      color: var(--text-main);
      display: flex;
      flex-direction: column;
    }

    a { color: inherit; text-decoration: none; }

    header {
      padding: 1.2rem 5vw 0.6rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.5rem;
    }

    .brand {
      display:flex;
      align-items:center;
      gap:0.65rem;
    }

    .brand img {
      height:32px;
      width:auto;
      display:block;
    }

    .header-right {
      display:flex;
      align-items:center;
      gap:0.8rem;
    }

    .nav-links {
      display:flex;
      gap:1rem;
      font-size:0.9rem;
      color:var(--text-muted);
    }

    .nav-links a {
      padding:0.25rem 0.7rem;
      border-radius:999px;
    }

    .nav-links a.active {
      color:var(--text-main);
      background:rgba(255,255,255,0.05);
    }

    .live-btn {
      padding:0.4rem 0.9rem;
      border-radius:999px;
      border:none;
      font-size:0.85rem;
      font-weight:600;
      cursor:pointer;
      background:linear-gradient(135deg,#ffb800,#ff6a00);
      color:#111;
      box-shadow:0 8px 24px rgba(0,0,0,0.6);
    }

    main {
      flex:1;
      padding:0.4rem 5vw 1.6rem;
      display:grid;
      grid-template-columns: minmax(0, 2.3fr) minmax(0, 1.3fr);
      gap:1.3rem;
    }

    .player-card {
      background: rgba(4, 8, 24, 0.96);
      border-radius: 1.1rem;
      border: 1px solid rgba(255,255,255,0.06);
      padding: 0.8rem 0.9rem 0.9rem;
      box-shadow: 0 18px 50px rgba(0,0,0,0.85);
      display:flex;
      flex-direction:column;
      gap:0.6rem;
    }

    .title {
      font-size:1.1rem;
      font-weight:600;
      margin-bottom:0.1rem;
    }

    .meta {
      font-size:0.85rem;
      color:var(--text-muted);
      margin-bottom:0.3rem;
    }

    iframe {
      width:100%;
      aspect-ratio:16 / 9;
      border:none;
      border-radius:0.9rem;
      background:#000;
      box-shadow:0 18px 45px rgba(0,0,0,0.9);
    }

    .disclaimer {
      font-size:0.8rem;
      color:var(--text-muted);
      margin-top:0.25rem;
    }

    .info-card {
      background: rgba(4, 8, 24, 0.96);
      border-radius: 1.1rem;
      border: 1px solid rgba(255,255,255,0.06);
      padding: 0.9rem 0.9rem 1rem;
      box-shadow: 0 18px 50px rgba(0,0,0,0.85);
      display:flex;
      flex-direction:column;
      gap:0.6rem;
    }

    .poster-wrapper {
      display:flex;
      gap:0.9rem;
      align-items:flex-start;
    }

    .poster-wrapper img {
      width:130px;
      border-radius:0.6rem;
      box-shadow:0 12px 35px rgba(0,0,0,0.9);
      object-fit:cover;
    }

    .tags {
      display:flex;
      flex-wrap:wrap;
      gap:0.3rem;
      font-size:0.8rem;
      color:var(--text-muted);
    }

    .tag-chip {
      padding:0.15rem 0.5rem;
      border-radius:999px;
      background:rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.08);
    }

    .overview {
      font-size:0.85rem;
      color:var(--text-muted);
      line-height:1.45;
      margin-top:0.3rem;
      max-width:32rem;
    }

    footer {
      padding: 0.8rem 5vw 1.2rem;
      font-size: 0.75rem;
      color: var(--text-muted);
      border-top: 1px solid rgba(255,255,255,0.05);
      text-align:center;
    }

    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      header {
        padding-inline:4vw;
      }

      main {
        padding-inline:4vw;
      }

      .title {
        font-size:1rem;
      }

      .meta {
        font-size:0.8rem;
      }

      iframe {
        border-radius:0.7rem;
      }

      .poster-wrapper {
        gap:0.6rem;
      }

      .poster-wrapper img {
        width:120px;
      }

      .overview {
        font-size:0.85rem;
        max-width:none;
      }
    }

    @media (max-width: 480px) {
      .poster-wrapper {
        flex-direction:row;
      }

      .poster-wrapper img {
        width:110px;
      }

      .title {
        font-size:0.95rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <a href="index.html" class="brand">
      <img src="https://raw.githubusercontent.com/Mubtasim2009/Aboutme/c74e8b467a2abce57120a9b1d39eb0edb8e1c038/assets/brand/LOGO.webp" alt="BDTV VOD logo" />
    </a>
    <div class="header-right">
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="search.html">Search</a>
        <a href="about.html">About</a>
      </nav>
      <button class="live-btn" onclick="window.location.href='live.html'">Live TV</button>
    </div>
  </header>

  <main>
    <section class="player-card">
      <div class="title" id="movieTitle">Loading…</div>
      <div class="meta" id="movieMeta"></div>
      <iframe id="movieFrame" allowfullscreen referrerpolicy="no-referrer"></iframe>
      <p class="disclaimer">
        Streams are provided by a third‑party host and may contain their own ads or external links.
      </p>
    </section>

    <aside class="info-card">
      <div class="poster-wrapper">
        <img id="posterImg" src="" alt="Poster" />
        <div>
          <div class="tags" id="movieTags"></div>
          <div class="overview" id="movieOverview"></div>
        </div>
      </div>
    </aside>
  </main>

  <footer>BDTV VOD.</footer>

  <script>
    const TMDB_API_KEY = "b14194d00ce48c36318eefa745bcdeec";
    const TMDB_BASE = "https://api.themoviedb.org/3";
    const TMDB_IMG_BASE = "https://image.tmdb.org/t/p/w300";

    const VIDKING_BASE = "https://www.vidking.net";

    function getMovieIdFromUrl() {
      const url = new URL(window.location.href);
      return url.searchParams.get("id");
    }

    async function fetchJson(url) {
      const res = await fetch(url);
      if (!res.ok) throw new Error("TMDB error " + res.status);
      return res.json();
    }

    async function loadMovie() {
      const id = getMovieIdFromUrl();
      if (!id) {
        document.getElementById("movieTitle").textContent = "Missing movie ID.";
        return;
      }

      // Set embed URL – we just load it in an iframe, no extra window.open
      const frame = document.getElementById("movieFrame");
      frame.src = `${VIDKING_BASE}/embed/movie/${encodeURIComponent(id)}`;

      if (!TMDB_API_KEY) {
        document.getElementById("movieTitle").textContent = "Movie player";
        return;
      }

      try {
        const url = `${TMDB_BASE}/movie/${encodeURIComponent(id)}?api_key=${TMDB_API_KEY}&language=en-US`;
        const data = await fetchJson(url);

        const title = data.title || "Untitled";
        const year = data.release_date ? data.release_date.slice(0,4) : "";
        const runtime = data.runtime ? `${data.runtime} min` : "";
        const rating = data.vote_average ? `⭐ ${data.vote_average.toFixed(1)}` : "";

        document.getElementById("movieTitle").textContent = title;
        document.getElementById("movieMeta").textContent =
          [year, runtime, rating].filter(Boolean).join(" • ");

        const tagContainer = document.getElementById("movieTags");
        tagContainer.innerHTML = "";
        (data.genres || []).forEach(g => {
          const span = document.createElement("span");
          span.className = "tag-chip";
          span.textContent = g.name;
          tagContainer.appendChild(span);
        });

        document.getElementById("movieOverview").textContent =
          data.overview || "No overview available.";

        const posterImg = document.getElementById("posterImg");
        if (data.poster_path) {
          posterImg.src = TMDB_IMG_BASE + data.poster_path;
        } else {
          posterImg.src = "https://via.placeholder.com/300x450?text=No+Image";
        }
        posterImg.alt = title + " poster";

      } catch (err) {
        console.error(err);
        document.getElementById("movieTitle").textContent = "Failed to load movie details.";
      }
    }

    loadMovie();
  </script>
</body>
</html>